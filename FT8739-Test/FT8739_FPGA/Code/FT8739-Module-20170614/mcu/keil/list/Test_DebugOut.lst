C251 COMPILER V5.54.0.0,  Test_DebugOut                                                    22/06/17  10:59:17  PAGE 1   


C251 COMPILER V5.54.0.0, COMPILATION OF MODULE Test_DebugOut
OBJECT MODULE PLACED IN .\obj\Test_DebugOut.obj
COMPILER INVOKED BY: D:\Program Files (x86)\keil\C251\BIN\C251.EXE ..\..\src\source\task\Test_DebugOut.c XSMALL ROM(HUGE
                    -) OPTIMIZE(9,SPEED) BROWSE INCDIR(..\..\src\include;..\..\src\include\Debug;..\..\src\include\Drv;..\..\src\include\task
                    -;..\..\src\include\config) STRING(FAR) DEBUG PRINT(.\list\Test_DebugOut.lst) TABS(2) OBJECT(.\obj\Test_DebugOut.obj) 

stmt  level    source

    1          /*******************************************************************************
    2          * Copyright (C) 2012-2013, FocalTech Systems (R)，All Rights Reserved.
    3          *
    4          * File Name: Test_DebugOut.c
    5          *
    6          *    Author: 
    7          *
    8          *   Created: 2017-04-18
    9          *
   10          *  Abstract:
   11          *
   12          * Reference: :
   13          * Version:
   14          * 0.1:
   15          *
   16          *******************************************************************************/
   17          
   18          /*******************************************************************************
   19          * 1.Included header files
   20          *******************************************************************************/
   21          #include "Test_DebugOut.h"
   22          
   23          #if _TEST_DEBUGOUT_EN
   24          /*******************************************************************************
   25          * 2.Private constant and macro definitions using #define
   26          *******************************************************************************/
   27          typedef enum
   28          {
   29            TEST_AFE_TEST_OUT_L0   = 0x00,
   30            TEST_AFE_TEST_OUT_L1   = 0x01,
   31            TEST_AFE_TEST_OUT_R0   = 0x02,
   32            TEST_AFE_TEST_OUT_R1   = 0x03,
   33            TEST_AFE_SCAN_START    = 0x04,
   34            TEST_AFE_STB_START     = 0x05,
   35            TEST_AFE_ARAM_RDY      = 0x06,
   36            TEST_AFE_FRAME_END_R   = 0x07,
   37            TEST_AFE_TP_BUSY_R     = 0x08,
   38            TEST_AFE_MON_DET_R     = 0x09,
   39            TEST_AFE_FRAME_END_L   = 0x0A,
   40            TEST_AFE_TP_BUSY_L     = 0x0B,
   41            TEST_AFE_MON_DET_L     = 0x0C,
   42            TEST_LCD_VSTART        = 0x0D,
   43            TEST_LCD_VMIN          = 0x0E,
   44            TEST_LCD_VEND          = 0x0F,
   45            TEST_LCD_VBLANK        = 0x10,
   46            TEST_LCD_TCON_L_VBP    = 0x11,
   47            TEST_LCD_TP_STANDBY    = 0x12,
   48            TEST_LCD_RUN           = 0x13,
   49            TEST_LCD_BUSY          = 0x14,
   50            TEST_LCD_SYNC_MISS     = 0x15,
   51            TEST_LCD_VDO_MODE      = 0x16,
   52            TEST_LCD_IDLE_MODE     = 0x17,
   53            TEST_LCD_3BDITHER_MODE = 0x18,
   54            TEST_LCD_FR_ODD_EVEN   = 0x19,
   55            TEST_TP_VB_MODE_REQ    = 0x1A,
   56            TEST_LCD_VB_MODE_ACK   = 0x1B,
   57            TEST_LCD_LPF_MODE_EN   = 0x1C,
C251 COMPILER V5.54.0.0,  Test_DebugOut                                                    22/06/17  10:59:17  PAGE 2   

   58            TEST_TP_LPF_MODE_REQ   = 0x1D,
   59            TEST_LCD_LPF_MODE_ACK  = 0x1E,
   60            TEST_LCD_WR_ENABLE     = 0x1F,
   61            TEST_TP_XBUS_AEN       = 0x20,
   62            TEST_TP_XBUS_REN       = 0x21,
   63            TEST_TP_XBUS_DEN       = 0x22,
   64            TEST_LCD_RELOAD_START  = 0x23,
   65            TEST_TP_RELOAD_END     = 0x24,
   66            TEST_TP_RELOAD_ABORT   = 0x25,
   67            TEST_LCD_DSTB          = 0x26,
   68            TEST_LVD_MASK          = 0x27,
   69            TEST_BGP_MASK          = 0x28,
   70            TEST_VDD_TP_MASK_N1    = 0x29,
   71            TEST_VDD_TP_MASK_N2    = 0x2A,
   72            TEST_VDD_TP_MASK_N3    = 0x2B,
   73            TEST_AFE_POWERGATING_L = 0x2C,
   74            TEST_VREFBG_EN_L       = 0x2D,
   75            TEST_VREFTP_EDTOP_EN_L = 0x2E,
   76            TEST_VREFTP_BUF_EN_L   = 0x2F,
   77            TEST_VREFTP_SH_L       = 0x30,
   78            TEST_VREFTP_SRCTRL_L   = 0x31,
   79            TEST_VDD5_SETOP_EN_L   = 0x32,
   80            TEST_VDD5_BUF_EN_L     = 0x33,
   81            TEST_VDD5_SRCTRL_L     = 0x34,
   82            TEST_AFE_POWERGATING_R = 0x35,
   83            TEST_VREFBG_EN_R       = 0x36,
   84            TEST_VREFTP_EDTOP_EN_R = 0x37,
   85            TEST_VREFTP_BUF_EN_R   = 0x38,
   86            TEST_VREFTP_SH_R       = 0x39,
   87            TEST_VREFTP_SRCTRL_R   = 0x3A,
   88            TEST_VDD5_SETOP_EN_R   = 0x3B,
   89            TEST_VDD5_BUF_EN_R     = 0x3C,
   90            TEST_VDD5_SRCTRL_R     = 0x3D,
   91            TEST_OSC48M_SSCG0      = 0x3E,
   92            TEST_OSC48M_SSCG1      = 0x3F,
   93            TEST_OSC48M_SSCG2      = 0x40,
   94            TEST_TP_R_L_SEL        = 0x41,
   95            TEST_VCOM_OPT_SEL      = 0x42,
   96            TEST_VREFTP_SRCTRL     = 0x43,
   97            TEST_VREFTP_SH         = 0x44,
   98            TEST_VREFTP_BUF_EN     = 0x45,
   99            TEST_VREFTP_SETOP_EN   = 0x46,
  100            TEST_ARAM_ERRMAP       = 0x47,
  101            TEST_DRAM2_ERRMAP      = 0x48,
  102            TEST_DRAM1_ERRMAP      = 0x49,
  103            TEST_DRAM0_ERRMAP      = 0x4A,
  104            TEST_PRAM4_ERRMAP      = 0x4B,
  105            TEST_PRAM3_ERRMAP      = 0x4C,
  106            TEST_PRAM2_ERRMAP      = 0x4D,
  107            TEST_PRAM1_ERRMAP      = 0x4E,
  108            TEST_PRAM0_ERRMAP      = 0x4F,
  109            TEST_TABRAM_ERRMAP_L   = 0x50,
  110            TEST_RPTRAM_ERRMAP_L   = 0x51,
  111            TEST_ACCRAM_ERRMAP_L   = 0x52,
  112            TEST_TABRAM_ERRMAP_R   = 0x53,
  113            TEST_RPTRAM_ERRMAP_R   = 0x54,
  114            TEST_ACCRAM_ERRMAP_R   = 0x55,
  115            TEST_SPI0_TEST_OUT0    = 0x56,
  116            TEST_SPI0_TEST_OUT1    = 0x57,
  117            TEST_SPI0_TEST_OUT2    = 0x58,
  118            TEST_SPI0_TEST_OUT3    = 0x59,
  119            TEST_SPI0_TEST_OUT4    = 0x5A,
  120            TEST_SPI0_TEST_OUT5    = 0x5B,
  121            TEST_SPI0_TEST_OUT6    = 0x5C,
  122            TEST_SPI0_TEST_OUT7    = 0x5D,
  123            TEST_SPI0_TEST_OUT8    = 0x5E,
C251 COMPILER V5.54.0.0,  Test_DebugOut                                                    22/06/17  10:59:17  PAGE 3   

  124            TEST_SPI0_TEST_OUT9    = 0x5F,
  125            TEST_SPI0_TEST_OUT10   = 0x60,
  126            TEST_SPI0_TEST_OUT11   = 0x61
  127          }ENUM_TEST_CON;
  128          
  129          /*******************************************************************************
  130          * 3.Private enumerations, structures and unions using typedef
  131          *******************************************************************************/
  132          
  133          /*******************************************************************************
  134          * 4.Static variables
  135          *******************************************************************************/
  136          
  137          /*******************************************************************************
  138          * 5.Global variable or extern global variabls/functions
  139          *******************************************************************************/
  140          
  141          /*******************************************************************************
  142          * 6.Static function prototypes
  143          *******************************************************************************/
  144          
  145          /*******************************************************************************
  146          *   Name:
  147          *  Brief:
  148          *  Input:
  149          * Output:
  150          * Return:
  151          *******************************************************************************/
  152          void Test_CLk48M(void)
  153          {
  154   1        UINT8 ucDiv = 5;
  155   1          #if _UART_OUT_GPIO2
                       DBG_DEBUGOUT("\nP0_6 is used to be UART TX pad!");
                       return;
                   #endif
  159   1        
  160   1        if((UART_INH == 0)&&(UART_INL == 1))
  161   1        {
  162   2              DBG_DEBUGOUT("\nP0_6 is used to be UART RX pad and now is changed to be CLK Test Pin!");
  163   2          UART_INH = 0;
  164   2          UART_INL = 0;
  165   2        }
  166   1          P0MOD |= BITn(6);
  167   1          TEST_OUT3_EN = 0;
  168   1          GPIO_INT_SEL = 1;//将唤醒脚选为p0_7
  169   1          TEST_CLK_EN = 1;
  170   1      
  171   1          CGUCON7 = ucDiv;   //osc_test_div
  172   1      
  173   1          DBG_DEBUGOUT("\nP0MOD:%02x",P0MOD);
  174   1          DBG_DEBUGOUT("\nTESTCON3:%02x",TESTCON3);
  175   1          DBG_DEBUGOUT("\nANACON:%02x",ANACON);
  176   1          DBG_DEBUGOUT("\nFT_EN_REG:%02x",FT_EN_REG);
  177   1          DBG_DEBUGOUT("\nCUGCON7:%02x",CGUCON7);    
  178   1          DBG_DEBUGOUT("\nTest Clk 48M");
  179   1      }
  180          
  181          /*******************************************************************************
  182          *   Name:
  183          *  Brief:
  184          *  Input:
  185          * Output:
  186          * Return:
  187          *******************************************************************************/
  188          void Test_CLk32K(void)
  189          {
C251 COMPILER V5.54.0.0,  Test_DebugOut                                                    22/06/17  10:59:17  PAGE 4   

  190   1        UINT8 ucDiv = 3;//分频系数.0,1,2为2分频;其他按实际配置分频
  191   1        UINT8 ucSrc = 2;//3:32k_from_1m;2:32k_dig;1:32k osc;0:48m
  192   1        
  193   1          #if _UART_OUT_GPIO2
                       DBG_DEBUGOUT("\nP0_6 is used to be UART TX pad!");
                       return;
                   #endif
  197   1      
  198   1        if((UART_INH == 0)&&(UART_INL == 1))
  199   1        {
  200   2              DBG_DEBUGOUT("\nP0_6 is used to be UART RX pad and now is changed to be CLK Test Pin!");
  201   2          UART_INH = 0;
  202   2          UART_INL = 0;
  203   2        } 
  204   1        
  205   1          P0MOD |= BITn(6);
  206   1          TEST_OUT3_EN = 0;
  207   1          GPIO_INT_SEL = 1;            //将唤醒脚选为p0_7
  208   1          TEST_CLK_EN = 1;
  209   1      
  210   1        if(ucSrc == 1)
  211   1        {
  212   2          SEL_32K_SRC = 1;         //写1可以发出,写0不行
  213   2        }
  214   1        else if(ucSrc == 2)
  215   1        {
  216   2          PROBE32K_DIG_EN = 1;    
  217   2        }
  218   1        else if(ucSrc == 3)
  219   1        {
  220   2          PROBE32K_FROM1M_EN = 1;
  221   2          SEL_32K_SRC = 0;         //fpga目前写1或者写0都可以发出
  222   2        }
  223   1        
  224   1        CGUCON7 = (ucSrc << 6)|(ucDiv);
  225   1      
  226   1          DBG_DEBUGOUT("\nP0MOD:%02x",P0MOD);
  227   1        DBG_DEBUGOUT("\nDSVCON:%02x",DSV_CON);
  228   1          DBG_DEBUGOUT("\nTESTCON3:%02x",TESTCON3);
  229   1          DBG_DEBUGOUT("\nSYSCON:%02x",SYSCON);
  230   1          DBG_DEBUGOUT("\nFT_EN_REG:%02x",FT_EN_REG);
  231   1          DBG_DEBUGOUT("\nCUGCON7:%02x",CGUCON7);    
  232   1          DBG_DEBUGOUT("\nTest Clk 32K");
  233   1      }
  234          
  235          /*******************************************************************************
  236          *   Name:Test_CON0
  237          *  Brief:
  238          *  Input:
  239          * Output:
  240          * Return:
  241          *******************************************************************************/
  242          void Test_CON0(ENUM_TEST_CON ucSignal)
  243          {
  244   1        TEST_OUT0_EN = 1;
  245   1          
  246   1        TESTCON0 |= ucSignal; 
  247   1      }
  248          
  249          /*******************************************************************************
  250          *   Name:Test_CON1
  251          *  Brief:
  252          *  Input:
  253          * Output:
  254          * Return:
  255          *******************************************************************************/
C251 COMPILER V5.54.0.0,  Test_DebugOut                                                    22/06/17  10:59:17  PAGE 5   

  256          void Test_CON1(ENUM_TEST_CON ucSignal)
  257          {
  258   1        TEST_OUT1_EN = 1;
  259   1          
  260   1        TESTCON1 |= ucSignal; 
  261   1      }
  262          
  263          /*******************************************************************************
  264          *   Name:Test_CON2
  265          *  Brief:
  266          *  Input:
  267          * Output:
  268          * Return:
  269          *******************************************************************************/
  270          void Test_CON2(ENUM_TEST_CON ucSignal)
  271          {
  272   1          if(BUS_SEL == 1)//spi0
  273   1          {
  274   2              P1MOD |= BITn(2);//p1_2;
  275   2          }
  276   1          else
  277   1          {
  278   2              SPI_REPLACE_EN = 0;
  279   2              P0MOD |= BITn(2);//P0_2;
  280   2          }
  281   1      
  282   1        TEST_OUT2_EN = 1;
  283   1          
  284   1        TESTCON2 |= ucSignal; 
  285   1      }
  286          
  287          /*******************************************************************************
  288          *   Name:Test_CON3
  289          *  Brief:
  290          *  Input:
  291          * Output:
  292          * Return:
  293          *******************************************************************************/
  294          void Test_CON3(ENUM_TEST_CON ucSignal)
  295          {
  296   1      
  297   1          P0MOD |= BITn(6);
  298   1      
  299   1        TEST_OUT3_EN = 1;
  300   1          
  301   1        TESTCON3 |= ucSignal; 
  302   1      }
  303          
  304          
  305          /*******************************************************************************
  306          *   Name:
  307          *  Brief:
  308          *  Input:
  309          * Output:
  310          * Return:
  311          *******************************************************************************/
  312          void Test_DebugOut(void)//AFE相关信号的测试放在AFE测试代码里面
  313          {
  314   1      
  315   1      #if 0
                   while(1)
                   {
                       P0_6 = !P0_6;
                       DelayMs(10);
                   }
               #endif
C251 COMPILER V5.54.0.0,  Test_DebugOut                                                    22/06/17  10:59:17  PAGE 6   

  322   1          Test_CON0(TEST_LCD_BUSY);   //从tp2pad_dsv_en6出信号
  323   1          //Test_CON1(TEST_LCD_RUN);    //从led_pwm[0]出信号
  324   1          Test_CON2(TEST_LCD_VSTART); //当用SPI0时,从P0_0出信号,当用IIC时，从p0_2出信号
  325   1      
  326   1      #if 1    
  327   1          Test_CON3(TEST_LCD_VMIN);   //从p0_6出信号
  328   1      # elif 0
                   Test_CLk48M();              //从p0_6出信号
               #else
                   Test_CLk32K();              //从p0_6出信号
               #endif
  333   1      
  334   1      }
  335          #endif
  336          


Module Information          Static   Overlayable
------------------------------------------------
  code size            =    ------     ------
  ecode size           =       456     ------
  data size            =    ------     ------
  idata size           =    ------     ------
  pdata size           =    ------     ------
  xdata size           =    ------     ------
  xdata-const size     =    ------     ------
  edata size           =    ------     ------
  bit size             =    ------     ------
  ebit size            =    ------     ------
  bitaddressable size  =    ------     ------
  ebitaddressable size =    ------     ------
  far data size        =    ------     ------
  huge data size       =    ------     ------
  const size           =    ------     ------
  hconst size          =       195     ------
End of Module Information.


C251 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
